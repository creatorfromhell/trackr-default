function initJSPalette(){document.getElementById("jspalette").innerHTML=paletteHTML,initCanvas(),drawColorChooser()}function initCanvas(){colorChooserCanvas=document.getElementById("color-chooser"),colorChooserContext=colorChooserCanvas.getContext("2d"),shadeChooserCanvas=document.getElementById("shade-chooser"),shadeChooserContext=shadeChooserCanvas.getContext("2d"),addListeners()}function addListeners(){colorChooserCanvas.addEventListener("mousedown",function(o){ismouseDown=!0,changeColor(o)},!1),colorChooserCanvas.addEventListener("mouseup",function(){ismouseDown=!1},!1),colorChooserCanvas.addEventListener("mousemove",function(o){ismouseDown&&changeColor(o)},!1),colorChooserCanvas.addEventListener("mouseout",function(){ismouseDown=!1},!1),shadeChooserCanvas.addEventListener("mousedown",function(o){ismouseDown=!0,chooseShade(o)},!1),shadeChooserCanvas.addEventListener("mouseup",function(){ismouseDown=!1},!1),shadeChooserCanvas.addEventListener("mousemove",function(o){ismouseDown&&chooseShade(o)},!1),shadeChooserCanvas.addEventListener("mouseout",function(){ismouseDown=!1},!1),document.getElementById("picked-color").addEventListener("change",function(){var o=document.getElementById("picked-color").value;shadeColor="#"==o.substr(0,1)?o:"#"+o,document.getElementById("picked-color").value=shadeColor,document.getElementById("chosen-color").style.background=shadeColor,drawShadeChooser()},!1)}function drawColorChooser(){drawMainChooser(),drawShadeChooser()}function drawMainChooser(){var o=colorChooserContext.createLinearGradient(0,130,130,130);o.addColorStop(0,"#ED1212"),o.addColorStop(.2,"#E6EC13"),o.addColorStop(.3,"#17EC13"),o.addColorStop(.5,"#15EAE7"),o.addColorStop(.7,"#1F16E9"),o.addColorStop(.85,"#D817E8"),o.addColorStop(1,"#ED1212");var e=colorChooserContext.createLinearGradient(0,0,0,155);e.addColorStop(.5,"rgba(255, 255, 255, 0.0)"),e.addColorStop(.85,"grey"),colorChooserContext.fillStyle=o,colorChooserContext.fillRect(0,0,130,130),colorChooserContext.fillStyle=e,colorChooserContext.fillRect(0,0,130,140)}function drawShadeChooser(){var o=shadeChooserContext.createLinearGradient(0,0,12,130);o.addColorStop(.1,"#000"),o.addColorStop(.5,shadeColor),o.addColorStop(.9,"#fff"),shadeChooserContext.fillStyle=o,shadeChooserContext.fillRect(0,0,12,130)}function changeColor(o){var e=colorChooserCanvas.getBoundingClientRect(),t=e.top,n=e.left,d=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,a=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,s=d+n,r=a+t;mouseX=o.pageX-s,mouseY=o.pageY-r;var c=colorChooserContext.getImageData(mouseX,mouseY,1,1).data;shadeColor=rgbToHex(c[0],c[1],c[2]),document.getElementById("picked-color").value=shadeColor,document.getElementById("chosen-color").style.background=shadeColor,drawShadeChooser()}function chooseShade(o){var e=shadeChooserCanvas.getBoundingClientRect(),t=e.top,n=e.left,d=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,a=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,s=d+n,r=a+t;mouseX=o.pageX-s,mouseY=o.pageY-r;var c=shadeChooserContext.getImageData(mouseX,mouseY,1,1).data,l=rgbToHex(c[0],c[1],c[2]);document.getElementById("picked-color").value=l,document.getElementById("chosen-color").style.background=l}function componentToHex(o){var e=o.toString(16);return 1==e.length?"0"+e:e}function rgbToHex(o,e,t){return"#"+componentToHex(o)+componentToHex(e)+componentToHex(t)}var colorChooserCanvas,colorChooserContext,shadeChooserCanvas,shadeChooserContext,shadeColor="#15EAE7",ismouseDown=!1,paletteHTML='<div id="color-container"><div id="color-outcome"><div id="chosen-color"></div><input type="text" id="picked-color" value="#15EAE7"></div><div id="chooser-background"><div id="chooser-icon"></div><canvas id="color-chooser" width="130" height="130"></canvas></div><div id="shade-background"><div id="shader-slider"></div><canvas id="shade-chooser" width="12" height="130"></canvas></div></div><div id="palette-controls"><button id="jspalette-close" class="jspalette-control" style="float: left;">Close</button><button id="jspalette-choose" class="jspalette-control" style="float: right;">Choose</button></div>',mouseX=0,mouseY=0;window.onload=function(){initJSPalette()};